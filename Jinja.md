## Jinja

### Урок 1


Jinja - модуль, который служит для обработки шаблонов в Python. Входит в модуль Django.  
```python  
from jinja2 import Template #импортируем класс Template из библиотеки Jinja


name = "Федор"

tm = Template("Привет {{ name }}")  #в фигурных скобках стоит ссылка на переменную name
msg = tm.render(name=name)  # указатель будет ссылаться на переменную name

print(msg)
```


Конструкции внутри шаблонов Jinja:  
1. {%%} - спецификатор шаблона  
2. {{}} - выражение для вставки конструкций Python в шаблон  
3. {##} - блок комментариев  
4. '# ##' - строковый комментарий 


```python  
from jinja2 import Template #импортируем класс Template из библиотеки Jinja

name = "Федор"
age = 28

tm = Template("Привет, меня зовут {{ n }}. Мне {{ a }} лет")  #в фигурных скобках стоят ссылки на переменные name и age
msg = tm.render(n=name, a = age)  # указатель будет ссылаться на переменную name

print(msg)
```


Именнованные параметры внутри метода render воспринимаются как словарь, где ключ это указатель на переменную (n или a в примере выше), а значение - сами переменные (name, age).  
Внутри фигурных скобок можно писать любые конструкции языка Python:  
```python  
from jinja2 import Template #импортируем класс Template из библиотеки Jinja

name = "Федор"
age = 28

tm = Template("Привет, меня зовут {{ n.upper() }}. Мне {{ a*2 }} лет")  # возраст усножаем на 2, а имя выводится заглавными буквами

print(msg)
```  


Пример можно усложнить классом:
 ```python  
from jinja2 import Template

class Person(): #создаем класс Person
    def __init__(self, name, age):
        self.name = name
        self.age = age

    def get_name(self): #геттер имени
        return self.name

    def get_age(self): # геттер возраста
        return self.age

person = Person("Федор", 28)

tm = Template("Привет, меня зовут {{ p.get_age() }}, мне {{ p.get_name()  }} лет") #внутри скобок обращаемся к соответствующим свойствам класса Person при помощи указателя p
msg = tm.render(p=person) #создаем ссылку на экземпляр класса

print(msg)
```  


Данные в шаблон можно передать с помощью словаря.
 ```python  
from jinja2 import Template

per = {'name': 'Федор', 'age': 34}

tm = Template("Привет, меня зовут {{ p.age }}, мне {{ p.name }} лет") #внутри скобок прописываем ключи словаря per
msg = tm.render(p=person) #создаем ссылку на экземпляр класса

print(msg)
``` 


Также можем обратиться к ключу при помощи следующей конструкции:
 ```python  
from jinja2 import Template

per = {'name': 'Федор', 'age': 34}

tm = Template("Привет, меня зовут {{ p.['age'] }}, мне {{ p.['name'] }} лет") #обращаемся по имени ключа
msg = tm.render(p=person) #создаем ссылку на экземпляр класса

print(msg)
```


### Урок 2


Способы экранирования данных в строках. Экранирование необходимо когда мы хотим чтобы {{ name }} не изменялось, а передавалось в print как есть, не подставляя значение 'Федор'
```python  
from jinja2 import Template

data = '''Модуль jinja вместо определения  {{ name }} подставляет соответствующее значение'''

tm = Template(data)
msg = tm.render(name='Федор')

print (msg)  
```  
Для этого в jinja есть специальный блок {%raw%}...{%endraw%} все что помещается внутрь него никак не преобразуется.  
```python  
from jinja2 import Template

data = '''{%raw%}Модуль jinja вместо определения  {{ name }} подставляет соответствующее значени{%endraw%}е'''

tm = Template(data)
msg = tm.render(name='Федор')

print (msg) 
```


При работе с текстовыми html шаблонами часто возникает необходимость экранирования некоторых символов, которые браузером воспринимаются как определения тегов.  
Экранирование в браузерах заключается в том чтобы текст в браузерах выводить не как тэг ссылку, а в виде текста.
```python  
from jinja2 import Template

link = '''В HTML-документе ссылки определяются так:
<a href="#">Ссылка</a>''' #специальные символы

tm = Template("{{link | e}}") #формируем шаблон с переменной link. После вертикальной черты идет флаг e, который означает экранирование специальных символов
msg = tm.render(link=link) #Присваиваем параметру строку link

print(msg)
# в выводе текст представлен в виде специальных символов. В выводе увидим:
# &lt;a href=&#34;#&#34;&gt;Ссылка&lt;/a&gt
```  
Теперь в браузере отображается не ссылка, а текст '<a href="#">Ссылка</a>'.  
Так как на практике операция выполняется довольно часто, в модуле jinja есть класс escape, который выполняет эту операцию.
```python  
from jinja2 import Template
from markupsafe import escape #импортируем класс escape

link = '''В HTML-документе ссылки определяются так:
<a href="#">Ссылка</a>''' #специальные символы

msg = escape(link)
print(msg)  
```
